<?xml version="1.0" encoding="UTF-8"?>
<itop_design xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" version="1.3">
   <portals>
      <portal id="backoffice" _delta="must_exist">
         <deny>
            <profile id="IP Portal user" _delta="define"/>
         </deny>
      </portal>
      <portal id="teemip-portal" _delta="define">
         <rank>1.0</rank>
         <url>pages/exec.php?exec_module=itop-portal-base&amp;exec_page=index.php&amp;portal_id=teemip-portal</url>
         <handler />
         <allow>
            <profile id="IP Portal user"/>
            <profile id="Administrator"/>
            <profile id="Hostmaster"/>
         </allow>
      </portal>
   </portals>
   <module_designs>
      <module_design id="teemip-portal" xsi:type="portal" _delta="define">
         <properties>
            <name>portal:teemip-portal</name>
            <!-- Can be either a fileref or a relative path to the file (To 
               be tested). Takes over env-xxx/branding/portal-logo.png -->
            <!--<fileref ref="brt_6a2be154b2a62659d3332c513bdad715"/> -->
            <!--<logo>../images/itop-logo.png</logo> -->
            <!-- Can be either a fileref or a relative path to the file from 
               /env-xxx -->
            <!-- Available themes must have a unique id. Some ids are loaded 
               in a specific order : bootstrap/portal/custom. Other ids are loaded after 
               them, but their order cannot be predicted -->
            <themes />
            <!-- Can be either a fileref or a relative path to the file from 
               /env-xxx -->
            <!-- Available templates are id="layout|home" -->
            <templates />
            <!-- An OQL query to determine which TriggerOnPortalUpdate to 
               use within THIS instance of the portal. This is mostly needed to enable different 
               triggers on several portal instances -->
            <!-- Note : ":parent_classes" parameter is a reserved name that 
               will be used for the current object class name (and its ancestors) -->
            <triggers_query><![CDATA[SELECT TriggerOnPortalUpdate AS t WHERE t.target_class IN (:parent_classes)]]></triggers_query>
            <attachments>
               <allow_delete>true</allow_delete>
            </attachments>
            <urlmaker_class>TeemIpPortalURLMaker</urlmaker_class>
         </properties>
         <bricks>
            <brick id="user-profile" xsi:type="Combodo\iTop\Portal\Brick\UserProfileBrick">
               <rank>
                  <default>1</default>
               </rank>
               <title>
                  <default>Brick:Portal:UserProfile:Navigation:Dropdown:MyProfil</default>
               </title>
               <decoration_class>
                  <default>fa fa-user fa-2x</default>
               </decoration_class>
               <form>
                  <!-- Optionnal tag to list the fields -->
                  <fields />
                  <!-- Optionnal tag to specify the form layout. Fields that 
                     are not positionned in the layout will be placed at the end of the form -->
                  <twig>
                     <!-- data-field-id attribute must be an attribute code 
                        of the class -->
                     <!-- data-field-flags attribute contains flags among 
                        read_only/hidden/mandatory/must_prompt/must_change -->
                     <div class="form_field" data-field-id="first_name" data-field-flags="read_only"/>
                     <div class="form_field" data-field-id="name" data-field-flags="read_only"/>
                     <div class="form_field" data-field-id="org_id" data-field-flags="read_only"/>
                     <div class="form_field" data-field-id="email" data-field-flags="read_only"/>
                     <div class="form_field" data-field-id="phone"/>
                     <div class="form_field" data-field-id="location_id"/>
                     <div class="form_field" data-field-id="function"/>
                     <div class="form_field" data-field-id="manager_id" data-field-flags="read_only"/>
                  </twig>
               </form>
            </brick>
            <brick id="quick-new-iprequest-extended" xsi:type="Combodo\iTop\Portal\Brick\CreateBrick" _delta="define">
               <active>true</active>
               <rank>
                  <default>10</default>
               </rank>
               <width>6</width>
               <modal>true</modal>
               <title>
                  <default>Brick:Portal:QuickNewTicket:Title</default>
               </title>
               <description>Brick:Portal:QuickNewTicket:Title+</description>
               <visible>
                  <home>false</home>
               </visible>
               <decoration_class>
                  <default>fa fa-bolt fa-2x fa-fw</default>
               </decoration_class>
               <!-- Class that will be create created with the form -->
               <class>IPRequest</class>
               <rules>
                  <rule id="contact-to-iprequest"/>
               </rules>
            </brick>
            <brick id="ongoing-tickets-for-portal-user" xsi:type="Combodo\iTop\Portal\Brick\ManageBrick">
               <active>true</active>
               <rank>
                  <default>20</default>
               </rank>
               <width>6</width>
               <title>
                  <default>Brick:Portal:OngoingRequests:Title</default>
               </title>
               <description>Brick:Portal:OngoingRequests:Title+</description>
               <decoration_class>
                  <default>fc fc-ongoing-request fc-2x</default>
               </decoration_class>
               <oql><![CDATA[SELECT IPRequest]]></oql>
               <!-- Optional tag to define the how the objects should be 
                  opened. Values can be edit|view. Note that even if this is set to edit, objects 
                  not allowed in edition mode for the user (cf. scopes and security layers) 
                  will open in view mode -->
               <!-- <opening_mode>edit</opening_mode> -->
               <!-- Can be either a class tag with the class name or an oql 
                  tag with the query -->
               <!-- <class>Ticket</class> -->
               <fields>  
                  <field id="title"/>
                  <field id="start_date"/>
                  <field id="status"/>
               </fields>
               <!-- Optional tag to add attributes to the table by their 
                  code -->
               <grouping>
                  <!-- Optionnal -->
                  <tabs>
                     <!-- Optionnal. Grouping by tabs -->
                     <!--<attribute>operational_status</attribute> -->
                     <!-- attribute xor groups tag -->
                     <groups>
                        <!-- Can be used only with ../oql tag, not ../class 
                           tag. Reason is that we can't know the class alias to apply to the condition's 
                           fields. We might have an exception saying that the field in ambigious for 
                           the generated query. -->
                        <group id="recent">
                           <rank>1</rank>
                           <title>Brick:Portal:OngoingRequests:Tab:Recent</title>
                           <condition><![CDATA[SELECT IPRequest WHERE (status != 'closed') AND (start_date > DATE(DATE_SUB(NOW(), INTERVAL 7 DAY))) ]]></condition>
                        </group>
                        <group id="opened">
                           <rank>2</rank>
                           <title>Brick:Portal:OngoingRequests:Tab:OnGoing</title>
                           <condition><![CDATA[SELECT IPRequest WHERE status NOT IN ('closed', 'resolved')]]></condition>
                        </group>
                        <group id="resolved">
                           <rank>3</rank>
                           <title>Brick:Portal:OngoingRequests:Tab:Resolved</title>
                           <condition><![CDATA[SELECT IPRequest WHERE status = 'resolved']]></condition>
                        </group>
                     </groups>
                  </tabs>
                  <!-- Implicit grouping on y axis by finalclass -->
               </grouping>
               <data_loading>full</data_loading>
            </brick>
            <brick id="closed-tickets-for-portal-user" xsi:type="Combodo\iTop\Portal\Brick\ManageBrick">
               <active>true</active>
               <rank>
                  <navigation_menu>50</navigation_menu>
               </rank>
               <visible>
                  <home>false</home>
               </visible>
               <width>12</width>
               <title>
                  <default>Brick:Portal:ClosedRequests:Title</default>
               </title>
               <description />
               <decoration_class>
                  <default>fc fc-closed-request fc-2x</default>
               </decoration_class>
               <oql><![CDATA[SELECT IPRequest WHERE org_id = :current_contact->org_id AND caller_id = :current_contact_id AND status = 'closed']]></oql>
               <!-- Can be either a class tag with the class name or an oql 
                  tag with the query -->
               <!-- <class>Ticket</class> -->
               <fields>  
                  <field id="title"/>
                  <field id="start_date"/>
                  <field id="status"/>
               </fields>
               <grouping>
                  <!-- Optionnal -->
                  <tabs>
                     <!-- Optionnal. Grouping by tabs -->
                     <!--<attribute>operational_status</attribute> -->
                     <!-- attribute xor groups tag -->
                     <groups>
                        <!-- Can be used only with ../oql tag, not ../class
                           tag. Reason is that we can't know the class alias to apply to the condition's
                           fields. We might have an exception saying that the field in ambigious for
                           the generated query. -->
                        <group id="recent">
                           <rank>1</rank>
                           <title>Brick:Portal:OngoingRequests:Tab:Recent</title>
                           <condition><![CDATA[SELECT IPRequest WHERE (status = 'resolved') AND (start_date > DATE(DATE_SUB(NOW(), INTERVAL 7 DAY))) ]]></condition>
                        </group>
                        <group id="resolved">
                           <rank>2</rank>
                           <title>Brick:Portal:OngoingRequests:Tab:Resolved</title>
                           <condition><![CDATA[SELECT IPRequest WHERE status = 'resolved']]></condition>
                        </group>
                     </groups>
                  </tabs>
                  <!-- Implicit grouping on y axis by finalclass -->
               </grouping>
               <data_loading>auto</data_loading>
            </brick>
         </bricks>
         <forms>
            <form id="iprequestaddresscreatev4-create">
               <class>IPRequestAddressCreateV4</class>
               <properties>
                  <navigation_rules>
                     <submit>
                        <default>go-to-open-request-on-submit</default>
                     </submit>
                  </navigation_rules>
               </properties>
               <fields />
               <twig>
                  <div>
                     <div class="form_field" data-field-id="title" data-field-flags="mandatory"/>
                     <div class="form_field" data-field-id="description" data-field-flags="mandatory"/>
                  </div>
                  <div class="row">
                     <div class="col-sm-4">
                        <div class="form_field" data-field-id="status_ip" />
                     </div>
                  </div>
                  <div class="row">
                     <div class="col-sm-4">
                        <div class="form_field" data-field-id="block_id" data-field-flags="mandatory" />
                     </div>
                     <div class="col-sm-4">
                        <div class="form_field" data-field-id="subnet_id" data-field-flags="mandatory" />
                     </div>
                     <div class="col-sm-4">
                        <div class="form_field" data-field-id="range_id" />
                     </div>
                  </div>
                  <div class="row">
                     <div class="col-sm-4">
                        <div class="form_field" data-field-id="location_id" />
                     </div>
                     <div class="col-sm-4">
                        <div class="form_field" data-field-id="short_name" />
                     </div>
                     <div class="col-sm-4">
                        <div class="form_field" data-field-id="domain_id" />
                     </div>
                  </div>
                  <div class="row">
                     <div class="col-sm-4">
                        <div class="form_field" data-field-id="usage_id" />
                     </div>
                  </div>
                  <div class="row">
                     <div class="col-sm-4">
                        <div class="form_field" data-field-id="ciclass" />
                     </div>
                     <div class="col-sm-4">
                        <div class="form_field" data-field-id="connectableci_id" />
                     </div>
                     <div class="col-sm-4">
                        <div class="form_field" data-field-id="ci_ip_attribute" />
                     </div>
                  </div>
               </twig>
               <modes>
                  <!-- mode id can among create / edit / view -->
                  <mode id="create"/>
               </modes>
            </form>
            <form id="iprequestaddresscreatev4-edit">
               <class>IPRequestAddressCreateV4</class>
               <fields />
               <twig>
                  <div class="row">
                     <div class="col-sm-8">
                        <div class="form_field" data-field-id="title" data-field-flags="read_only" />
                     </div>
                     <div class="col-sm-4">
                        <div class="form_field" data-field-id="status" data-field-flags="read_only" />
                     </div>
                  </div>
                  <div class="row">
                     <div class="col-sm-12">
                        <div class="form_field" data-field-id="description" data-field-flags="read_only" />
                     </div>
                  </div>
                  <div class="row">
                     <div class="col-sm-4">
                        <div class="form_field" data-field-id="ip_id_friendlyname" data-field-flags="read_only" />
                     </div>
                     <div class="col-sm-4">
                        <div class="form_field" data-field-id="status_ip" data-field-flags="read_only" />
                     </div>
                     <div class="col-sm-4">
                        <div class="form_field" data-field-id="usage_id_friendlyname" data-field-flags="read_only" />
                     </div>
                  </div>
                  <div class="row">
                     <div class="col-sm-4">
                        <div class="form_field" data-field-id="block_id_friendlyname" data-field-flags="read_only" />
                     </div>
                     <div class="col-sm-4">
                        <div class="form_field" data-field-id="subnet_id_friendlyname" data-field-flags="read_only" />
                     </div>
                     <div class="col-sm-4">
                        <div class="form_field" data-field-id="range_id_friendlyname" data-field-flags="read_only" />
                     </div>
                  </div>
                  <div class="row">
                     <div class="col-sm-4">
                        <div class="form_field" data-field-id="location_id_friendlyname" data-field-flags="read_only" />
                     </div>
                     <div class="col-sm-4">
                        <div class="form_field" data-field-id="short_name" data-field-flags="read_only" />
                     </div>
                     <div class="col-sm-4">
                        <div class="form_field" data-field-id="domain_id_friendlyname" data-field-flags="read_only" />
                     </div>
                  </div>
                  <div class="row">
                     <div class="col-sm-4">
                        <div class="form_field" data-field-id="ciclass" data-field-flags="read_only" />
                     </div>
                     <div class="col-sm-4">
                        <div class="form_field" data-field-id="connectableci_id_friendlyname" data-field-flags="read_only" />
                     </div>
                     <div class="col-sm-4">
                        <div class="form_field" data-field-id="ci_ip_attribute" data-field-flags="read_only" />
                     </div>
                  </div>
                  <div>
                     <div class="form_field" data-field-id="public_log" />
                  </div>
               </twig>
               <modes>
                  <!-- mode id can among create / edit / view -->
                  <mode id="edit"/>
                  <mode id="view"/>
               </modes>
            </form>
            <form id="iprequestaddresscreatev6-create">
               <class>IPRequestAddressCreateV6</class>
               <properties>
                  <navigation_rules>
                     <submit>
                        <default>go-to-open-request-on-submit</default>
                     </submit>
                  </navigation_rules>
               </properties>
               <fields />
               <twig>
                  <div>
                     <div class="form_field" data-field-id="title" data-field-flags="mandatory"/>
                     <div class="form_field" data-field-id="description" data-field-flags="mandatory"/>
                  </div>
                  <div class="row">
                     <div class="col-sm-4">
                        <div class="form_field" data-field-id="status_ip" />
                     </div>
                  </div>
                  <div class="row">
                     <div class="col-sm-4">
                        <div class="form_field" data-field-id="block_id" data-field-flags="mandatory" />
                     </div>
                     <div class="col-sm-4">
                        <div class="form_field" data-field-id="subnet_id" data-field-flags="mandatory" />
                     </div>
                     <div class="col-sm-4">
                        <div class="form_field" data-field-id="range_id" />
                     </div>
                  </div>
                  <div class="row">
                     <div class="col-sm-4">
                        <div class="form_field" data-field-id="location_id" />
                     </div>
                     <div class="col-sm-4">
                        <div class="form_field" data-field-id="short_name" />
                     </div>
                     <div class="col-sm-4">
                        <div class="form_field" data-field-id="domain_id" />
                     </div>
                  </div>
                  <div class="row">
                     <div class="col-sm-4">
                        <div class="form_field" data-field-id="usage_id" />
                     </div>
                  </div>
                  <div class="row">
                     <div class="col-sm-4">
                        <div class="form_field" data-field-id="ciclass" />
                     </div>
                     <div class="col-sm-4">
                        <div class="form_field" data-field-id="connectableci_id" />
                     </div>
                     <div class="col-sm-4">
                        <div class="form_field" data-field-id="ci_ip_attribute" />
                     </div>
                  </div>
               </twig>
               <modes>
                  <!-- mode id can among create / edit / view -->
                  <mode id="create"/>
               </modes>
            </form>
            <form id="iprequestaddresscreatev6-edit">
               <class>IPRequestAddressCreateV6</class>
               <fields />
               <twig>
                  <div class="row">
                     <div class="col-sm-8">
                        <div class="form_field" data-field-id="title" data-field-flags="read_only" />
                     </div>
                     <div class="col-sm-4">
                        <div class="form_field" data-field-id="status" data-field-flags="read_only" />
                     </div>
                  </div>
                  <div class="row">
                     <div class="col-sm-12">
                        <div class="form_field" data-field-id="description" data-field-flags="read_only" />
                     </div>
                  </div>
                  <div class="row">
                     <div class="col-sm-4">
                        <div class="form_field" data-field-id="ip_id_friendlyname" data-field-flags="read_only" />
                     </div>
                     <div class="col-sm-4">
                        <div class="form_field" data-field-id="status_ip" data-field-flags="read_only" />
                     </div>
                     <div class="col-sm-4">
                        <div class="form_field" data-field-id="usage_id_friendlyname" data-field-flags="read_only" />
                     </div>
                  </div>
                  <div class="row">
                     <div class="col-sm-4">
                        <div class="form_field" data-field-id="block_id_friendlyname" data-field-flags="read_only" />
                     </div>
                     <div class="col-sm-4">
                        <div class="form_field" data-field-id="subnet_id_friendlyname" data-field-flags="read_only" />
                     </div>
                     <div class="col-sm-4">
                        <div class="form_field" data-field-id="range_id_friendlyname" data-field-flags="read_only" />
                     </div>
                  </div>
                  <div class="row">
                     <div class="col-sm-4">
                        <div class="form_field" data-field-id="location_id_friendlyname" data-field-flags="read_only" />
                     </div>
                     <div class="col-sm-4">
                        <div class="form_field" data-field-id="short_name" data-field-flags="read_only" />
                     </div>
                     <div class="col-sm-4">
                        <div class="form_field" data-field-id="domain_id_friendlyname" data-field-flags="read_only" />
                     </div>
                  </div>
                  <div class="row">
                     <div class="col-sm-4">
                        <div class="form_field" data-field-id="ciclass" data-field-flags="read_only" />
                     </div>
                     <div class="col-sm-4">
                        <div class="form_field" data-field-id="connectableci_id_friendlyname" data-field-flags="read_only" />
                     </div>
                     <div class="col-sm-4">
                        <div class="form_field" data-field-id="ci_ip_attribute" data-field-flags="read_only" />
                     </div>
                  </div>
                  <div>
                     <div class="form_field" data-field-id="public_log"/>
                  </div>
               </twig>
               <modes>
                  <!-- mode id can among create / edit / view -->
                  <mode id="edit"/>
                  <mode id="view"/>
               </modes>
            </form>
            <form id="iprequestaddressupdate-create">
               <class>IPRequestAddressUpdate</class>
               <properties>
                  <navigation_rules>
                     <submit>
                        <default>go-to-open-request-on-submit</default>
                     </submit>
                  </navigation_rules>
               </properties>
               <fields />
               <twig>
                  <div>
                     <div class="form_field" data-field-id="title" data-field-flags="mandatory"/>
                     <div class="form_field" data-field-id="description" data-field-flags="mandatory"/>
                  </div>
                  <div class="row">
                     <div class="col-sm-6">
                        <div class="form_field" data-field-id="ip_id" data-field-flags="mandatory"/>
                     </div>
                  </div>
                  <div class="row">
                     <div class="col-sm-6">
                        <div class="form_field" data-field-id="new_status_ip" />
                     </div>
                  </div>
                  <div class="row">
                     <div class="col-sm-6">
                        <div class="form_field" data-field-id="new_short_name" />
                     </div>
                     <div class="col-sm-6">
                        <div class="form_field" data-field-id="new_domain_id" />
                     </div>
                  </div>
                  <div class="row">
                     <div class="col-sm-6">
                        <div class="form_field" data-field-id="new_usage_id" />
                     </div>
                  </div>
               </twig>
               <modes>
                  <!-- mode id can among create / edit / view -->
                  <mode id="create" />
               </modes>
            </form>
            <form id="iprequestaddressupdate-edit">
               <class>IPRequestAddressUpdate</class>
               <fields />
               <twig>
                  <div class="row">
                     <div class="col-sm-8">
                        <div class="form_field" data-field-id="title" data-field-flags="read_only" />
                     </div>
                     <div class="col-sm-4">
                        <div class="form_field" data-field-id="status" data-field-flags="read_only" />
                     </div>
                  </div>
                  <div class="row">
                     <div class="col-sm-12">
                        <div class="form_field" data-field-id="description" data-field-flags="read_only" />
                     </div>
                  </div>
                  <div class="row">
                     <div class="col-sm-6">
                        <div class="form_field" data-field-id="ip_id_friendlyname" data-field-flags="read_only"/>
                     </div>
                  </div>
                  <div class="row">
                     <div class="col-sm-6">
                        <div class="form_field" data-field-id="new_status_ip" data-field-flags="read_only"/>
                     </div>
                  </div>
                  <div class="row">
                     <div class="col-sm-6">
                        <div class="form_field" data-field-id="new_short_name" data-field-flags="read_only"/>
                     </div>
                     <div class="col-sm-6">
                        <div class="form_field" data-field-id="new_domain_id_friendlyname" data-field-flags="read_only"/>
                     </div>
                  </div>
                  <div class="row">
                     <div class="col-sm-6">
                        <div class="form_field" data-field-id="new_usage_id_friendlyname" data-field-flags="read_only"/>
                     </div>
                  </div>
                  <div>
                     <div class="form_field" data-field-id="public_log"/>
                  </div>
               </twig>
               <modes>
                  <!-- mode id can among create / edit / view -->
                  <mode id="edit"/>
                  <mode id="view"/>
               </modes>
            </form>
            <form id="iprequestaddressdelete-create">
               <class>IPRequestAddressDelete</class>
               <properties>
                  <navigation_rules>
                     <submit>
                        <default>go-to-open-request-on-submit</default>
                     </submit>
                  </navigation_rules>
               </properties>
               <fields />
               <twig>
                  <div>
                     <div class="form_field" data-field-id="title" data-field-flags="mandatory"/>
                     <div class="form_field" data-field-id="description" data-field-flags="mandatory"/>
                     <div class="form_field" data-field-id="ip_id" data-field-flags="mandatory"/>
                 </div>
               </twig>
               <modes>
                  <!-- mode id can among create / edit / view -->
                  <mode id="create" />
               </modes>
            </form>
            <form id="iprequestaddressdelete-edit">
               <class>IPRequestAddressDelete</class>
               <fields />
               <twig>
                  <div class="row">
                     <div class="col-sm-8">
                        <div class="form_field" data-field-id="title" data-field-flags="read_only" />
                     </div>
                     <div class="col-sm-4">
                        <div class="form_field" data-field-id="status" data-field-flags="read_only" />
                     </div>
                  </div>
                  <div class="row">
                     <div class="col-sm-12">
                        <div class="form_field" data-field-id="description" data-field-flags="read_only" />
                     </div>
                  </div>
                  <div class="row">
                     <div class="col-sm-4">
                        <div class="form_field" data-field-id="ip_id_friendlyname" data-field-flags="read_only"/>
                     </div>
                  </div>
                  <div>S
                     <div class="form_field" data-field-id="public_log"/>
                  </div>
               </twig>
               <modes>
                  <!-- mode id can among create / edit / view -->
                  <mode id="edit"/>
                  <mode id="view"/>
               </modes>
            </form>
            <form id="iprequestsubnetcreatev4-create">
               <class>IPRequestSubnetCreateV4</class>
               <properties>
                  <navigation_rules>
                     <submit>
                        <default>go-to-open-request-on-submit</default>
                     </submit>
                  </navigation_rules>
               </properties>
               <fields />
               <twig>
                  <div>
                     <div class="form_field" data-field-id="title" data-field-flags="mandatory"/>
                     <div class="form_field" data-field-id="description" data-field-flags="mandatory"/>
                  </div>
                  <div class="row">
                     <div class="col-sm-4">
                        <div class="form_field" data-field-id="status_subnet" />
                     </div>
                  </div>
                  <div class="row">
                     <div class="col-sm-4">
                        <div class="form_field" data-field-id="block_id" data-field-flags="mandatory"/>
                     </div>
                     <div class="col-sm-4">
                        <div class="form_field" data-field-id="mask" data-field-flags="mandatory"/>
                     </div>
                  </div>
                  <div class="row">
                     <div class="col-sm-4">
                        <div class="form_field" data-field-id="location_id"/>
                     </div>
                     <div class="col-sm-4">
                        <div class="form_field" data-field-id="name"/>
                     </div>
                  </div>
                  <div class="row">
                     <div class="col-sm-4">
                        <div class="form_field" data-field-id="type" />
                     </div>
                  </div>
               </twig>
               <modes>
                  <!-- mode id can among create / edit / view -->
                  <mode id="create"/>
               </modes>
            </form>
            <form id="iprequestsubnetcreatev4-edit">
               <class>IPRequestSubnetCreateV4</class>
               <fields />
               <twig>
                  <div class="row">
                     <div class="col-sm-8">
                        <div class="form_field" data-field-id="title" data-field-flags="read_only" />
                     </div>
                     <div class="col-sm-4">
                        <div class="form_field" data-field-id="status" data-field-flags="read_only" />
                     </div>
                  </div>
                  <div class="row">
                     <div class="col-sm-12">
                        <div class="form_field" data-field-id="description" data-field-flags="read_only" />
                     </div>
                  </div>
                  <div class="row">
                     <div class="col-sm-4">
                        <div class="form_field" data-field-id="status_subnet" data-field-flags="read_only"/>
                     </div>
                     <div class="col-sm-4">
                        <div class="form_field" data-field-id="subnet_id_friendlyname" data-field-flags="read_only"/>
                     </div>
                  </div>
                  <div class="row">
                     <div class="col-sm-4">
                        <div class="form_field" data-field-id="block_id_friendlyname" data-field-flags="read_only"/>
                     </div>
                     <div class="col-sm-4">
                        <div class="form_field" data-field-id="mask" data-field-flags="read_only"/>
                     </div>
                  </div>
                  <div>
                     <div class="col-sm-4">
                        <div class="form_field" data-field-id="location_id_friendlyname" data-field-flags="read_only"/>
                     </div>
                     <div class="col-sm-4">
                        <div class="form_field" data-field-id="name" data-field-flags="read_only"/>
                     </div>
                  </div>
                  <div class="row">
                     <div class="col-sm-4">
                        <div class="form_field" data-field-id="type" data-field-flags="read_only"/>
                     </div>
                  </div>
                  <div>
                     <div class="form_field" data-field-id="public_log"/>
                  </div>
               </twig>
               <modes>
                  <!-- mode id can among create / edit / view -->
                  <mode id="edit"/>
                  <mode id="view"/>
               </modes>
            </form>
            <form id="iprequestsubnetcreatev6-create">
               <class>IPRequestSubnetCreateV6</class>
               <properties>
                  <navigation_rules>
                     <submit>
                        <default>go-to-open-request-on-submit</default>
                     </submit>
                  </navigation_rules>
               </properties>
               <fields />
               <twig>
                  <div>
                     <div class="form_field" data-field-id="title" data-field-flags="mandatory"/>
                     <div class="form_field" data-field-id="description" data-field-flags="mandatory"/>
                  </div>
                  <div class="row">
                     <div class="col-sm-4">
                        <div class="form_field" data-field-id="status_subnet" />
                     </div>
                  </div>
                  <div class="row">
                     <div class="col-sm-4">
                        <div class="form_field" data-field-id="block_id" data-field-flags="mandatory"/>
                     </div>
                     <div class="col-sm-4">
                        <div class="form_field" data-field-id="mask" data-field-flags="mandatory"/>
                     </div>
                  </div>
                  <div class="row">
                     <div class="col-sm-4">
                        <div class="form_field" data-field-id="location_id"/>
                     </div>
                     <div class="col-sm-4">
                        <div class="form_field" data-field-id="name"/>
                     </div>
                  </div>
                  <div class="row">
                     <div class="col-sm-4">
                        <div class="form_field" data-field-id="type" />
                     </div>
                  </div>
               </twig>
               <modes>
                  <!-- mode id can among create / edit / view -->
                  <mode id="create"/>
               </modes>
            </form>
            <form id="iprequestsubnetcreatev6-edit">
               <class>IPRequestSubnetCreateV6</class>
               <fields />
               <twig>
                  <div class="row">
                     <div class="col-sm-8">
                        <div class="form_field" data-field-id="title" data-field-flags="read_only" />
                     </div>
                     <div class="col-sm-4">
                        <div class="form_field" data-field-id="status" data-field-flags="read_only" />
                     </div>
                  </div>
                  <div class="row">
                     <div class="col-sm-12">
                        <div class="form_field" data-field-id="description" data-field-flags="read_only" />
                     </div>
                  </div>
                  <div class="row">
                     <div class="col-sm-4">
                        <div class="form_field" data-field-id="status_subnet" data-field-flags="read_only"/>
                     </div>
                     <div class="col-sm-4">
                        <div class="form_field" data-field-id="subnet_id_friendlyname" data-field-flags="read_only"/>
                     </div>
                  </div>
                  <div class="row">
                     <div class="col-sm-4">
                        <div class="form_field" data-field-id="block_id_friendlyname" data-field-flags="read_only"/>
                     </div>
                     <div class="col-sm-4">
                        <div class="form_field" data-field-id="mask" data-field-flags="read_only"/>
                     </div>
                  </div>
                  <div>
                     <div class="col-sm-4">
                        <div class="form_field" data-field-id="location_id_friendlyname" data-field-flags="read_only"/>
                     </div>
                     <div class="col-sm-4">
                        <div class="form_field" data-field-id="name" data-field-flags="read_only"/>
                     </div>
                  </div>
                  <div class="row">
                     <div class="col-sm-4">
                        <div class="form_field" data-field-id="type" data-field-flags="read_only"/>
                     </div>
                  </div>
                  <div>
                     <div class="form_field" data-field-id="public_log"/>
                  </div>
               </twig>
               <modes>
                  <!-- mode id can among create / edit / view -->
                  <mode id="edit"/>
                  <mode id="view"/>
               </modes>
            </form>
            <form id="iprequestsubnetupdate-create">
               <class>IPRequestSubnetUpdate</class>
               <properties>
                  <navigation_rules>
                     <submit>
                        <default>go-to-open-request-on-submit</default>
                     </submit>
                  </navigation_rules>
               </properties>
               <fields />
               <twig>
                  <div>
                     <div class="form_field" data-field-id="title" data-field-flags="mandatory"/>
                     <div class="form_field" data-field-id="description" data-field-flags="mandatory"/>
                  </div>
                  <div class="row">
                     <div class="col-sm-6">
                        <div class="form_field" data-field-id="subnet_id" data-field-flags="mandatory"/>
                     </div>
                  </div>
                  <div class="row">
                     <div class="col-sm-6">
                        <div class="form_field" data-field-id="new_status_subnet" />
                     </div>
                  </div>
                  <div class="row">
                     <div class="col-sm-4">
                        <div class="form_field" data-field-id="old_location_id" />
                     </div>
                     <div class="col-sm-4">
                        <div class="form_field" data-field-id="new_location_id" />
                     </div>
                     <div class="col-sm-4">
                        <div class="form_field" data-field-id="new_name" />
                     </div>
                  </div>
                  <div class="row">
                     <div class="col-sm-6">
                        <div class="form_field" data-field-id="new_type" />
                     </div>
                  </div>
               </twig>
               <modes>
                  <!-- mode id can among create / edit / view -->
                  <mode id="create" />
               </modes>
             </form>
            <form id="iprequestsubnetupdate-edit">
               <class>IPRequestSubnetUpdate</class>
               <fields />
               <twig>
                  <div class="row">
                     <div class="col-sm-8">
                        <div class="form_field" data-field-id="title" data-field-flags="read_only" />
                     </div>
                     <div class="col-sm-4">
                        <div class="form_field" data-field-id="status" data-field-flags="read_only" />
                     </div>
                  </div>
                  <div class="row">
                     <div class="col-sm-12">
                        <div class="form_field" data-field-id="description" data-field-flags="read_only" />
                     </div>
                  </div>
                  <div class="row">
                     <div class="col-sm-6">
                        <div class="form_field" data-field-id="subnet_id_friendlyname" data-field-flags="read_only"/>
                     </div>
                  </div>
                  <div class="row">
                     <div class="col-sm-6">
                        <div class="form_field" data-field-id="new_status_subnet" data-field-flags="read_only"/>
                     </div>
                  </div>
                  <div class="row">
                     <div class="col-sm-4">
                        <div class="form_field" data-field-id="old_location_id_friendlyname" data-field-flags="read_only"/>
                     </div>
                     <div class="col-sm-4">
                        <div class="form_field" data-field-id="new_location_id_friendlyname" data-field-flags="read_only"/>
                     </div>
                     <div class="col-sm-4">
                        <div class="form_field" data-field-id="new_name" data-field-flags="read_only"/>
                     </div>
                  </div>
                  <div class="row">
                     <div class="col-sm-6">
                        <div class="form_field" data-field-id="new_type" data-field-flags="read_only"/>
                     </div>
                  </div>
                  <div>
                     <div class="form_field" data-field-id="public_log"/>
                  </div>
               </twig>
               <modes>
                  <!-- mode id can among create / edit / view -->
                  <mode id="edit"/>
                  <mode id="view"/>
               </modes>
            </form>
            <form id="iprequestsubnetdelete-create">
               <class>IPRequestSubnetDelete</class>
               <properties>
                  <navigation_rules>
                     <submit>
                        <default>go-to-open-request-on-submit</default>
                     </submit>
                  </navigation_rules>
               </properties>
               <fields />
               <twig>
                  <div>
                     <div class="form_field" data-field-id="title" data-field-flags="mandatory"/>
                     <div class="form_field" data-field-id="description" data-field-flags="mandatory"/>
                     <div class="form_field" data-field-id="subnet_id" data-field-flags="mandatory"/>
                 </div>
               </twig>
               <modes>
                  <!-- mode id can among create / edit / view -->
                  <mode id="create" />
               </modes>
            </form>
            <form id="iprequestsubnetdelete-edit">
               <class>IPRequestSubnetDelete</class>
               <fields />
               <twig>
                  <div class="row">
                     <div class="col-sm-8">
                        <div class="form_field" data-field-id="title" data-field-flags="read_only" />
                     </div>
                     <div class="col-sm-4">
                        <div class="form_field" data-field-id="status" data-field-flags="read_only" />
                     </div>
                  </div>
                  <div class="row">
                     <div class="col-sm-12">
                        <div class="form_field" data-field-id="description" data-field-flags="read_only" />
                     </div>
                  </div>
                  <div class="row">
                     <div class="col-sm-4">
                        <div class="form_field" data-field-id="subnet_id_friendlyname" data-field-flags="read_only"/>
                     </div>
                  </div>
                  <div>
                     <div class="form_field" data-field-id="public_log"/>
                  </div>
               </twig>
               <modes>
                  <!-- mode id can among create / edit / view -->
                  <mode id="edit"/>
                  <mode id="view"/>
               </modes>
            </form>
         </forms>
         <classes>
            <!-- Note : A class (or one of its ancestors) MUST be declared 
                     here to be displayed in the portal -->
         <class id="FunctionalCI">
            <scopes>
               <scope id="all">
                  <oql_view><![CDATA[SELECT FunctionalCI WHERE org_id = :current_contact->org_id]]></oql_view>
                  <!-- oql_edit><![CDATA[SELECT FunctionalCI]]></oql_edit -->
               </scope>
            </scopes>
         </class>
         <class id="Contact">
            <scopes>
               <scope id="all">
                  <oql_view><![CDATA[SELECT Contact WHERE org_id = :current_contact->org_id]]></oql_view>
               </scope>
               <scope id="all">
                  <oql_view><![CDATA[SELECT Contact]]></oql_view>
                  <allowed_profiles>
                     <allowed_profile id="Administrator" />
                  </allowed_profiles>
               </scope>
            </scopes>
            <lists>
               <list id="default">
                  <items>
                     <item id="status">
                        <rank>10</rank>
                     </item>
                     <item id="org_id">
                        <rank>20</rank>
                     </item>
                     <item id="function">
                        <rank>50</rank>
                     </item>
                  </items>
               </list>
            </lists>
         </class>
         <class id="DNSObject">
            <scopes>
               <scope id="all">
                  <oql_view><![CDATA[SELECT DNSObject WHERE org_id = :current_contact->org_id]]></oql_view>
                  <oql_edit><![CDATA[SELECT DNSObject]]></oql_edit>
               </scope>
               <scope id="portal-power-user">
                  <oql_view><![CDATA[SELECT DNSObject WHERE org_id = :current_contact->org_id]]></oql_view>
                  <oql_edit><![CDATA[SELECT DNSObject]]></oql_edit>
                  <allowed_profiles>
                     <allowed_profile id="Portal power user" />
                  </allowed_profiles>
               </scope>
            </scopes>
         </class>
         <class id="IPObject">
            <scopes>
               <scope id="all">
                  <oql_view><![CDATA[SELECT IPObject WHERE org_id = :current_contact->org_id]]></oql_view>
                  <oql_edit><![CDATA[SELECT IPObject]]></oql_edit>
               </scope>
            </scopes>
         </class>
         <class id="IPRequest">
            <scopes>
               <scope id="all">
                  <oql_view><![CDATA[SELECT IPRequest WHERE caller_id = :current_contact_id]]></oql_view>
                  <oql_edit><![CDATA[SELECT IPRequest]]></oql_edit>
               </scope>
            </scopes>
         </class>
         <class id="IPUsage">
            <scopes>
               <scope id="all">
                  <oql_view><![CDATA[SELECT IPUsage WHERE org_id = :current_contact->org_id]]></oql_view>
                  <oql_edit><![CDATA[SELECT IPUsage]]></oql_edit>
               </scope>
            </scopes>
         </class>
         <class id="Location">
            <scopes>
               <scope id="all">
                  <oql_view><![CDATA[SELECT Location WHERE org_id = :current_contact->org_id]]></oql_view>
               </scope>
            </scopes>
         </class>
         <class id="Organization">
            <scopes>
               <scope id="all">
                  <oql_view><![CDATA[SELECT Organization WHERE id = :current_contact->org_id]]></oql_view>
               </scope>
            </scopes>
         </class>
         <class id="User">
            <scopes>
               <!-- Note : Silos apply to those scope queries -->
               <scope id="all">
                  <oql_view><![CDATA[SELECT User AS U JOIN Person AS P ON U.contactid=P.id WHERE P.id = :current_contact_id]]></oql_view>
               </scope>
            </scopes>
         </class>
         </classes>
         <action_rules>
            <action_rule id="contact-to-iprequest">
               <!-- source_oql|source_class is only necessary if there is some 
                  copy preset|retrofit -->
               <source_oql><![CDATA[SELECT Contact AS C WHERE C.id = :current_contact_id]]></source_oql>
               <presets>
                  <!-- Only set() and copy() are supported for now -->
                  <preset id="1">set(caller_id, $current_contact_id$)</preset>
                  <preset id="2">copy(org_id, org_id)</preset>
               </presets>
               <retrofits />
            </action_rule>
         </action_rules>
         <navigation_rules>
            <navigation_rule id="go-to-open-request-on-submit" xsi:type="go-to-manage-brick">
               <id>ongoing-tickets-for-portal-user</id>
            </navigation_rule>
         </navigation_rules>
      </module_design>
   </module_designs>
   <module_parameters>
      <parameters id="teemip-portal" _delta="define">
         <lazy_loading_threshold>500</lazy_loading_threshold><!-- Will be placed in the conf/<env>/config-itop.php file under the itop-portal module's settings  -->
      </parameters>
   </module_parameters>
   <snippets>
      <snippet id="TeemIpPortalURLMaker" _delta="define">
         <placement>module</placement>
         <rank>3</rank>
         <module>teemip-portal</module>
         <content><![CDATA[
use Combodo\iTop\Portal\UrlMaker\AbstractPortalUrlMaker;

require_once APPROOT.'/lib/autoload.php';

/**
* Hyperlinks to the "edition" of the object (vs view)
*/
class TeemIpPortalEditURLMaker extends AbstractPortalUrlMaker
{
    const PORTAL_ID = 'teemip-portal';
}

/**
 * Hyperlinks to the "view" of the object (vs edition)
 */
class TeemIpPortalViewUrlMaker extends TeemIpPortalEditUrlMaker
{
    /**
     * @inheritDoc
     */
    public static function MakeObjectURL($sClass, $iId)
    {
        return static::PrepareObjectURL($sClass, $iId, 'view');

    }
}

// Default portal hyperlink (for notifications) is the edit hyperlink
DBObject::RegisterURLMakerClass('teemip-portal', 'TeemIpPortalViewUrlMaker');
]]></content>
      </snippet>
   </snippets>
</itop_design>